<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Class Full Documentation</title>
    <link rel="stylesheet" href="style.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <header>
            <a href="index.html" style="color: white; text-decoration: none;"> <i class="fa-solid fa-arrow-left"></i> </a>
    <span>Upadate Class Documentation</span> <button id="modeToggle"> <i class="fas fa-moon"></i></button></header>
    </header>

    <main>
        <h2>Overview</h2>
        <p>
            The <code>Update</code> class is a PHP query builder designed for securely updating data in MySQL tables
            using prepared statements. It provides a fluent interface to construct complex <code>UPDATE</code> queries
            with robust features, including:
        </p>
        <ul>
            <li>Safe sanitization of table and column names to prevent SQL injection</li>
            <li>Support for <code>JOIN</code>, <code>WHERE</code>, and <code>OR WHERE</code> clauses for precise
                targeting</li>
            <li><code>ORDER BY</code> and <code>LIMIT</code> for controlled updates</li>
            <li>Automatic detection of parameter types for secure binding</li>
            <li>Return of the executed SQL query and the number of affected rows</li>
        </ul>
        <p>This class simplifies updating database records by abstracting raw SQL into a chainable syntax, ensuring
            security and flexibility for complex update operations.</p>

        <h2>Full Method Reference</h2>

        <div class="method">
            <h3>__construct()</h3>
            <p>Initializes a new instance of the <code>Update</code> class and establishes a connection to the MySQL
                database. This method prepares the internal state for building the update query.</p>
            <p><strong>Example:</strong></p>
            <pre>$update = new Update();</pre>
            <p><strong>Notes:</strong> Requires a valid database configuration (e.g., host, user, password). Throws an
                exception if the connection fails.</p>
        </div>

        <div class="method">
            <h3>table(<code>$table</code>)</h3>
            <p>Specifies the target table for the <code>UPDATE</code> query. The table name is sanitized to ensure it
                contains only valid characters (letters, numbers, underscores).</p>
            <table class="table">
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>$table</td>
                    <td>string</td>
                    <td>The name of the table to update</td>
                </tr>
            </table>
            <p><strong>Example:</strong></p>
            <pre>$update->table('users');</pre>
            <p><strong>Notes:</strong> Must be called before <code>set</code>, <code>where</code>, or <code>run</code>.
                Invalid table names will throw an exception.</p>
        </div>

        <div class="method">
            <h3>set(<code>array $values</code>)</h3>
            <p>Defines the column-value pairs to update in the table. Column names are sanitized, and values are bound
                using prepared statements with automatic type detection for security.</p>
            <table class="table">
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>$values</td>
                    <td>array</td>
                    <td>Associative array mapping column names to their new values (e.g., ['name' => 'Alice', 'email' =>
                        'alice@example.com'])</td>
                </tr>
            </table>
            <p><strong>Example:</strong></p>
            <pre>
$update->set([
  'name' => 'Alice Updated',
  'email' => 'alice.updated@example.com'
]);
      </pre>
            <p><strong>Notes:</strong> Ensure column names exist in the table schema. Values can be strings, numbers, or
                null. Throws an exception if the array is empty.</p>
        </div>

        <div class="method">
            <h3>where(<code>$column, $operator, $value</code>)</h3>
            <p>Adds a <code>WHERE</code> condition to filter which rows to update. Supports multiple operators for
                flexible filtering.</p>
            <table class="table">
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>$column</td>
                    <td>string</td>
                    <td>Column to filter</td>
                </tr>
                <tr>
                    <td>$operator</td>
                    <td>string</td>
                    <td>Comparison operator: '=', '!=', '<', '>' , '<=' , '>=' , 'LIKE' , 'IN' </td>
                </tr>
                <tr>
                    <td>$value</td>
                    <td>mixed</td>
                    <td>Value to compare against</td>
                </tr>
            </table>
            <p><strong>Example:</strong></p>
            <pre>$update->where('id', '=', 5);</pre>
            <p><strong>Notes:</strong> Multiple <code>where</code> calls are combined with <code>AND</code>. Use
                prepared statements for secure value binding.</p>
        </div>

        <div class="method">
            <h3>orWhere(<code>$column, $operator, $value</code>)</h3>
            <p>Adds an <code>OR</code> condition to the <code>WHERE</code> clause, allowing alternative filtering
                conditions.</p>
            <table class="table">
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>$column</td>
                    <td>string</td>
                    <td>Column to filter</td>
                </tr>
                <tr>
                    <td>$operator</td>
                    <td>string</td>
                    <td>Comparison operator: '=', '!=', '<', '>' , '<=' , '>=' , 'LIKE' , 'IN' </td>
                </tr>
                <tr>
                    <td>$value</td>
                    <td>mixed</td>
                    <td>Value to compare against</td>
                </tr>
            </table>
            <p><strong>Example:</strong></p>
            <pre>$update->orWhere('status', '=', 'inactive');</pre>
            <p><strong>Notes:</strong> Use after a <code>where</code> call to create complex conditions. Combines with
                previous conditions using <code>OR</code>.</p>
        </div>

        <div class="method">
            <h3>join(<code>$table, $firstCol, $operator, $secondCol, $type</code>)</h3>
            <p>Adds a <code>JOIN</code> clause to update rows based on relationships with another table.</p>
            <table class="table">
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>$table</td>
                    <td>string</td>
                    <td>Name of the table to join</td>
                </tr>
                <tr>
                    <td>$firstCol</td>
                    <td>string</td>
                    <td>Column of the base table</td>
                </tr>
                <tr>
                    <td>$operator</td>
                    <td>string</td>
                    <td>Comparison operator (e.g., '=', '>', '<')< /td>
                </tr>
                <tr>
                    <td>$secondCol</td>
                    <td>string</td>
                    <td>Column of the joined table</td>
                </tr>
                <tr>
                    <td>$type</td>
                    <td>string</td>
                    <td>Type of JOIN: 'INNER', 'LEFT', or 'RIGHT'</td>
                </tr>
            </table>
            <p><strong>Example:</strong></p>
            <pre>$update->join('roles', 'users.role_id', '=', 'roles.id', 'LEFT');</pre>
            <p><strong>Notes:</strong> Ensure columns exist in their respective tables. The <code>$type</code> parameter
                is case-sensitive and defaults to <code>INNER</code> if invalid.</p>
        </div>

        <div class="method">
            <h3>orderBy(<code>$column, $direction</code>)</h3>
            <p>Adds an <code>ORDER BY</code> clause to control the order in which rows are updated, useful when combined
                with <code>limit</code>.</p>
            <table class="table">
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>$column</td>
                    <td>string</td>
                    <td>Column to sort by</td>
                </tr>
                <tr>
                    <td>$direction</td>
                    <td>string</td>
                    <td>Sort direction: 'ASC' or 'DESC'</td>
                </tr>
            </table>
            <p><strong>Example:</strong></p>
            <pre>$update->orderBy('id', 'DESC');</pre>
            <p><strong>Notes:</strong> Multiple <code>orderBy</code> calls can be chained for multi-column sorting.
                Invalid directions default to <code>ASC</code>.</p>
        </div>

        <div class="method">
            <h3>limit(<code>$limit</code>)</h3>
            <p>Restricts the number of rows to be updated, useful for precise control over update operations.</p>
            <table class="table">
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>$limit</td>
                    <td>integer</td>
                    <td>Maximum number of rows to update</td>
                </tr>
            </table>
            <p><strong>Example:</strong></p>
            <pre>$update->limit(1);</pre>
            <p><strong>Notes:</strong> Must be a non-negative integer. Often used with <code>orderBy</code> to ensure
                predictable updates.</p>
        </div>

        <div class="method">
            <h3>run()</h3>
            <p>Executes the constructed <code>UPDATE</code> query and returns an associative array containing the
                executed SQL string and the number of affected rows.</p>
            <table class="table">
                <tr>
                    <th>Return</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>Result</td>
                    <td>array</td>
                    <td>Array with 'sql' (the executed query) and 'affected_rows' (number of updated rows)</td>
                </tr>
            </table>
            <p><strong>Example:</strong></p>
            <pre>
$result = $update->run();
print_r($result);
      </pre>
            <div class="example-output">
                {
                "sql": "UPDATE users SET name = ?, email = ? WHERE id = ? ORDER BY id DESC LIMIT 1",
                "affected_rows": 1
                }
            </div>
            <p><strong>Notes:</strong> Throws an exception if the table, values, or query are invalid. Ensure all
                required methods (<code>table</code>, <code>set</code>) are called before execution.</p>
        </div>

        <h2>Example Full Update</h2>
        <p>This example demonstrates updating a specific user record with new name and email values, constrained by ID,
            ordered, and limited to one row.</p>
        <pre>
$update = new Update();

$update->table('users')
       ->set([
           'name' => 'Alice Updated',
           'email' => 'alice.updated@example.com'
       ])
       ->where('id', '=', 5)
       ->orderBy('id', 'DESC')
       ->limit(1);

$result = $update->run();

echo "Executed SQL: ".$result['sql'];
echo "Affected Rows: ".$result['affected_rows'];
    </pre>
        <div class="example-output">
            Executed SQL: UPDATE users SET name = ?, email = ? WHERE id = ? ORDER BY id DESC LIMIT 1<br>
            Affected Rows: 1
        </div>
        <p><strong>Notes:</strong> This query updates a single user record where the ID is 5, setting new values for the
            <code>name</code> and <code>email</code> columns. The <code>limit</code> ensures only one row is affected,
            and <code>orderBy</code> ensures deterministic behavior.</p>

    </main>

    <script src="mode.js"></script>
</body>

</html>